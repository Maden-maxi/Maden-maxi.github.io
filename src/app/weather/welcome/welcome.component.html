<div class="row">
  <div class="col-xs-12 col-md-3">
    <form #queryForm="ngForm" (submit)="search(queryForm, $event)">

      <md-select (change)="selectedValues = {}" placeholder="Search By" name="searchBy" [required]="true" [value]="selectedParam" [(ngModel)]="selectedParam">
        <md-option *ngFor="let param of searchByParams" [value]="param.param" >
          {{param.name}}
        </md-option>
      </md-select>
      <div></div>
      <md-radio-group name="typeWeather" [(ngModel)]="dataRoute">
        <md-radio-button value="weather">Weather</md-radio-button>
        <md-radio-button value="forecast">Forecast</md-radio-button>
      </md-radio-group>

      <div class="switch-inputs" [ngSwitch]="selectedParam">
        <ng-container *ngSwitchCase="searchByParams[1].param">
          <md-form-field [style.display]="'block'">
            <input mdInput pattern="[0-9]{5,10}" [required]="true" placeholder="City ID" [(ngModel)]="selectedValues.id" name="city_id">
          </md-form-field>
        </ng-container>
        <ng-container *ngSwitchCase="searchByParams[2].param">
          <md-form-field [style]="{display: 'block'}">
            <input mdInput [required]="true" pattern="^[0-9]{1,3}\.[0-9]{1,10}$" placeholder="Latitude" [(ngModel)]="selectedValues.lat" name="city_lat">
          </md-form-field>
          <md-form-field [style]="{display: 'block'}">
            <input mdInput [required]="true" pattern="^[0-9]{1,3}\.[0-9]{1,10}$" placeholder="Longitude" [(ngModel)]="selectedValues.lon" name="city_lon">
          </md-form-field>
        </ng-container>
        <ng-container *ngSwitchCase="searchByParams[3].param">
          <md-form-field>
            <input mdInput [required]="true" pattern="^[0-9]{5,6}" placeholder="Zip code" [(ngModel)]="selectedValues.zip_code" name="zip_code">
          </md-form-field>
          <md-form-field>
            <input mdInput placeholder="Country code" pattern="^[0-9]{5,6}" [(ngModel)]="selectedValues.country_code" name="country_code">
          </md-form-field>
        </ng-container>
        <ng-container *ngSwitchDefault>
          <md-form-field>
            <input mdInput [required]="true" placeholder="City Name" min="2" maxlength="50" [(ngModel)]="selectedValues.city_name" name="city_name">
          </md-form-field>
          <md-form-field>
            <input mdInput placeholder="City code" pattern="[A-Za-z]{2,4}" [(ngModel)]="selectedValues.city_code" name="city_code">
          </md-form-field>
        </ng-container>

        <button [disabled]="!queryForm.valid" md-mini-fab>
          <md-icon>search</md-icon>
        </button>
        <a routerLink="." (click)="queryForm.resetForm(); weatherData = null" md-mini-fab>
          <md-icon>refresh</md-icon>
        </a>
      </div>
    </form>
  </div>
  <div class="col-xs-12 col-md-9">
    <div class="row mmgFadeIn" *ngIf="weatherData">

      <ng-container *ngIf="dataRoute == 'weather'; else forecast_template">
        <div class="col-xs-12 weather-map-location">
          <agm-map class="mmgFadeIn" [latitude]="weatherData.coord.lat" [longitude]="weatherData.coord.lon">
            <agm-marker [latitude]="weatherData.coord.lat" [longitude]="weatherData.coord.lon"></agm-marker>
          </agm-map>
        </div>
        <app-weather-card class="col-xs-12" [sys]="weatherData.sys" [clouds]="weatherData.clouds" [main]="weatherData.main" [wind]="weatherData.wind" [dt]="weatherData.dt" [city]="{name: weatherData.name, country: weatherData.sys.country}" [weather]="weatherData.weather"></app-weather-card>
      </ng-container>
      <ng-template #forecast_template>

        <div class="col-xs-12 weather-map-location">
          <agm-map class="mmgFadeIn" [latitude]="weatherData.city.coord.lat" [longitude]="weatherData.city.coord.lon">
            <agm-marker [latitude]="weatherData.city.coord.lat" [longitude]="weatherData.city.coord.lon"></agm-marker>
          </agm-map>
        </div>
        <div class="col-xs-12">
          <md-card>
            <md-card-title>Forecasts in {{weatherData.city.name}}, {{weatherData.city.country | uppercase}}</md-card-title>
            <md-card-content class="flex">
              <app-weather-chart [weather]="weatherData"></app-weather-chart>
            </md-card-content>
          </md-card>
        </div>

        <div class="col-md-12" *ngFor="let weatherItem of weatherData.list">
          <app-weather-card
            [wind]="weatherItem.wind"
            [clouds]="weatherItem.clouds"
            [dt]="weatherItem.dt_txt"
            [main]="weatherItem.main"
            [city]="weatherData.city"
            [sys]="weatherItem.sys"
            [rain]="weatherItem.rain"
            [weather]="weatherItem.weather"></app-weather-card>
        </div>

      </ng-template>

    </div>
  </div>
</div>
